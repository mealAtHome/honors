<ons-page id="GFPL">

    <!-- --------------- -->
    <!-- 페이지용 타이틀 -->
    <!-- --------------- -->
    <ons-toolbar id="GFPL-toolbar">
        <div class="left"><gg-backbtn onclick="GFPL.close(true);"></gg-backbtn></div>
        <div class="center"><span id="GFPL-span-title">구매이력</span></div>
    </ons-toolbar>

    <!-- 구매이력 -->
    <div class="common-div-cushion">

        <!-- 타이틀 -->
        <!-- <div class="common-div-formTitle"> -->
            <!-- <span>구매이력</span> -->
            <!-- <span class="GFPL-span-choosedPosition"></span> -->
        <!-- </div> -->

        <!-- 구매이력 -->
        <div class="common-div-formField">
            <span>구매이력</span>
            <span>모임의 구매이력을 모두 표시합니다.</span>
            <div class="common-div-cushionUD">
                <button class="common-btn-inline" id="GFPL-btn-addOne">구매추가</button>
            </div>
            <hr class="common-hr-paddingUD">
            <div id="GFPL-div-list" class="common-tag-fontsize09"></div>
        </div>

    </div> <!-- common-div-cushion -->

    <script>
        var GFPL =
        {
            code : "GFPL",
            Data: {},

            /* ===================== */
            /* show */
            /* ===================== */
            show()
            {
                if(Common.isEmpty(GFPL.Data.grpno))    { Common.toast("잘못된 접근입니다."); GFPL.close(true); return; }
                if(Common.isEmpty(GFPL.Data.pagenum))  { GFPL.Data.pagenum = 1; }

                /* init */
                Common.showProgress();
                setTimeout(function()
                {
                    try
                    {
                        /* vars */
                        let grpno = GFPL.Data.grpno;
                        let pagenum = GFPL.Data.pagenum;

                        /* get list */
                        let mGrpfncPurchases = Api.GrpfncPurchase.selectByGrpnoPagenum(grpno, pagenum, GGF.none, GGF.toast);
                        if(mGrpfncPurchases.isSuccess())
                        {
                            mGrpfncPurchases.makeTable("#GFPL-div-list");
                            $("#GFPL-div-list .common-btn-pagenationBtn").click(function()
                            {
                                GFPL.Data.pagenum = $(this).attr("pagenum");
                                GFPL.show();
                            });
                        }
                    }
                    catch(e)
                    {
                        console.error(e);
                        Common.toast("오류가 발생했습니다.");
                        GFPL.close(true);
                        return;
                    }
                    finally
                    {
                        Common.hideProgress();
                    }
                }, ajaxDelayTime);
            },

            /* ========================= */
            /* close */
            /* ========================= */
            close(force=false)
            {
                if(force == true)
                {
                    Navigation.moveBack();
                    return;
                }
                Navigation.moveBack();
            },
        }

        $(document).ready(function()
        {
            /* ======================== */
            /* event */
            /* ======================== */
            $("#GFPL-btn-addOne").click(function() { Navigation.moveFrontPage(Navigation.Page.B1031GrpFinancePurchaseUpdate, { grpno: GFPL.Data.grpno, }); });

            /* ========================= */
            /* page process */
            /* ========================= */

            /* get data from Config */
            try
            {
                GFPL.Data = Navigation.getPageParam();
                Navigation.executeShow();
            }
            catch(e)
            {
                console.error(e);
                GFPL.close(true);
            }

        });

    </script>


</ons-page>